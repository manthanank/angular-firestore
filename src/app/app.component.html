<div class="container" style="width: 600px">
  <div>
    <h3 style="text-align: center">Upoad file</h3>
  </div>
  <div
    class="alert alert-danger"
    role="alert"
    style="text-align: center"
    *ngIf="error"
  >
    {{ error }}
  </div>
  <div class="my-3">
    <form [formGroup]="fileForm">
      <div class="form-group">
        <label for="file">Excel File Only</label>
        <input
          type="file"
          class="form-control"
          id="file"
          name="file"
          formControlName="file"
          (change)="selectFile($event)"
          accept=".xlsx, .xls"
        />
      </div>
      <div class="container">
        <button
          (click)="uploadFileData()"
          type="submit"
          class="btn btn-primary"
          [disabled]="!fileForm.valid"
        >
          Submit
        </button>
      </div>
    </form>
  </div>

  <div class="my-2">
    <button
      type="submit"
      class="btn btn-primary"
      (click)="exportexcel()"
      [disabled]="!postedData"
    >
      Export to Excel
    </button>
  </div>
  <div class="my-2">{{ data }}</div>
</div>
<div class="container">
  <form [formGroup]="excelFileForm">
    <div class="row">
      <input
        type="file"
        class="form-control"
        id="file"
        name="file"
        formControlName="excelFile"
        (change)="updateData($event)"
        accept=".xlsx, .xls"
      />
    </div>
  </form>
  <form [formGroup]="excelForm">
    <div class="row">
      <div class="row">
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="leadTitle"
          >
            <option value="">Select required</option>
            <option>{{ leadTitle }}</option>
          </select>
        </div>
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="contactName"
          >
            <option value="">Select required</option>
            <option>{{ contactName }}</option>
          </select>
        </div>
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="leadSource"
          >
            <option value="">Select required</option>
            <option>{{ leadSource }}</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="companyName"
          >
            <option value="">Select required</option>
            <option>{{ companyName }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="product"
          >
            <option value="">Select required</option>
            <option>{{ product }}</option>
          </select>
        </div>
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="countryCode"
          >
            <option value="">Select required</option>
            <option>{{ countryCode }}</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="email"
          >
            <option value="">Select required</option>
            <option>{{ email }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="assignToTeamName"
          >
            <option value="">Select required</option>
            <option>{{ assignToTeamName }}</option>
          </select>
        </div>
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="assignToUserEmail"
          >
            <option value="">Select required</option>
            <option>{{ assignToUserEmail }}</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="note"
          >
            <option value="">Select required</option>
            <option>{{ note }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="address"
          >
            <option value="">Select required</option>
            <option>{{ address }}</option>
          </select>
        </div>
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="city"
          >
            <option value="">Select required</option>
            <option>{{ city }}</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="state"
          >
            <option value="">Select required</option>
            <option>{{ state }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="region"
          >
            <option value="">Select required</option>
            <option>{{ region }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="postalCode"
          >
            <option value="">Select required</option>
            <option>{{ postalCode }}</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="countryName"
          >
            <option value="">Select required</option>
            <option>{{ countryName }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="Age"
          >
            <option value="">Select required</option>
            <option>{{ Age }}</option>
          </select>
        </div>

        <div class="col">
          <div class="col">Column Name :</div>
          <select
            class="form-select"
            aria-label="Default select example"
            formControlName="Salary"
          >
            <option value="">Select required</option>
            <option>{{ Salary }}</option>
          </select>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="container">
        <button class="btn btn-primary" type="submit" (click)="updateExcel()">
          Update
        </button>
      </div>
    </div>
  </form>
</div>
<div>
  <table class="table" id="excel-table">
    <thead>
      <tr>
        <th scope="col" *ngFor="let key of tabkey">{{ key }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of postedData; index as i">
        <th scope="row">{{ i + 1 }}</th>
        <td>{{ item.leadTitle }}</td>
        <td>{{ item.contactName }}</td>
        <td>{{ item.leadSource }}</td>
        <td>{{ item.companyName }}</td>
        <td>{{ item.product }}</td>
        <td>{{ item.countryCode }}</td>
        <td>{{ item.email }}</td>
        <td>{{ item.assignToTeamName }}</td>
        <td>{{ item.assignToUserEmail }}</td>
        <td>{{ item.note }}</td>
        <td>{{ item.address }}</td>
        <td>{{ item.city }}</td>
        <td>{{ item.state }}</td>
        <td>{{ item.region }}</td>
        <td>{{ item.postalCode }}</td>
        <td>{{ item.countryName }}</td>
        <td>{{ item.Age }}</td>
        <td>{{ item.Salary }}</td>
      </tr>
    </tbody>
  </table>
</div>
<table>
  <thead>
    <tr *ngFor="let key of tabkey">
      {{
        key
      }}
    </tr>
  </thead>
</table>
